<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìù Travel Schedule</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-orange: #FF8C00;
            --light-orange: #FFF3E0;
            --dark-text: #333;
            --white: #ffffff;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f9f9f9;
            color: var(--dark-text);
            margin: 0;
            padding: 0;
        }

        header {
            background: linear-gradient(135deg, #FF6F00, #FF8C00);
            color: var(--white);
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 { margin: 0; font-size: 2.5em; }
        header p { margin-top: 10px; font-size: 1.1em; opacity: 0.9; }

        .container {
            max-width: 800px;
            margin: 40px auto;
            padding: 0 20px;
            position: relative;
        }

        /* Timeline Styles */
        .timeline {
            position: relative;
            padding: 0;
            list-style: none;
        }

        /* ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏Å‡∏ô‡∏Å‡∏•‡∏≤‡∏á */
        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 20px; /* Mobile View */
            width: 4px;
            background: #ddd;
            border-radius: 2px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 40px;
            padding-left: 60px; /* Mobile View */
        }

        /* ‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏°‡πÜ ‡∏ö‡∏ô‡πÄ‡∏™‡πâ‡∏ô */
        .timeline-marker {
            position: absolute;
            left: 11px; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏™‡πâ‡∏ô (20px) - ‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á marker (22px/2) + border adjustment */
            top: 0;
            width: 22px;
            height: 22px;
            background: var(--white);
            border: 4px solid var(--primary-orange);
            border-radius: 50%;
            z-index: 2;
        }

        .timeline-content {
            background: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary-orange);
            transition: transform 0.2s;
        }

        .timeline-content:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .time-badge {
            background: var(--light-orange);
            color: var(--primary-orange);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 10px;
        }

        .date-header {
            font-size: 1.2em;
            color: #777;
            margin-bottom: 15px;
            border-bottom: 2px dashed #eee;
            padding-bottom: 5px;
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô */
        }
        
        .date-header.show {
            display: block;
        }

        h3 { margin: 0 0 10px 0; color: #E65100; }
        p { margin: 0; line-height: 1.6; color: #555; }

        .activity-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-top: 15px;
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ */
        }

        /* Loading State */
        #loading { text-align: center; padding: 50px; color: #888; }

        /* Responsive for Desktop */
        @media (min-width: 768px) {
            .timeline::before { left: 50%; margin-left: -2px; }
            
            .timeline-item {
                width: 50%;
                padding-left: 0;
                padding-right: 40px;
                left: 0;
            }
            
            .timeline-item:nth-child(even) {
                left: 50%;
                padding-left: 40px;
                padding-right: 0;
            }

            .timeline-item:nth-child(even) .timeline-content {
                border-left: none;
                border-right: 5px solid var(--primary-orange);
            }

            .timeline-marker {
                left: 50%;
                margin-left: -11px;
            }
        }
    </style>
</head>
<body>

<header>
    <h1><i class="fas fa-plane-departure"></i> Travel Schedule üìù</h1>
    <p>Timetable‚úàÔ∏è</p>
</header>

<div class="container">
    <div id="loading"><i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
    <ul class="timeline" id="timeline-container">
        </ul>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

<script>
    // ==========================================
    // üü† ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡∏¥‡πâ‡∏á‡∏Ñ‡πå CSV ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1)
    // ==========================================
    const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSjnYu4EMm4xlYqKA0PuPDVRU6-X7H7aCkXm70gokacZ-vPPa-J9-QXzQb5O-m7sGTdHZbE_9cE_sd5/pub?gid=0&single=true&output=csv'; 

    function init() {
        Papa.parse(SHEET_CSV_URL, {
            download: true,
            header: true,
            complete: function(results) {
                renderTimeline(results.data);
            },
            error: function(err) {
                document.getElementById('loading').innerHTML = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                console.error(err);
            }
        });
    }

    function renderTimeline(data) {
        const container = document.getElementById('timeline-container');
        const loading = document.getElementById('loading');
        
        loading.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô Loading
        
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤
        data.sort((a, b) => {
            return new Date(a.Date + ' ' + a.Time) - new Date(b.Date + ' ' + b.Time);
        });

        let lastDate = '';

        data.forEach(item => {
            // ‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á
            if(!item.Activity) return; 

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            let dateHeaderHTML = '';
            if (item.Date !== lastDate) {
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°
                const dateObj = new Date(item.Date);
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const dateStr = dateObj.toLocaleDateString('th-TH', options);
                
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô Card ‡πÄ‡∏•‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥ Logic ‡πÅ‡∏¢‡∏Å
                // ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏ô Logic ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                lastDate = item.Date;
            }

            const li = document.createElement('li');
            li.className = 'timeline-item';

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
            const imgHTML = item.Image ? `<img src="${item.Image}" class="activity-img" alt="image">` : '';

            li.innerHTML = `
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                    <div class="time-badge"><i class="far fa-clock"></i> ${item.Date} | ${item.Time} ‡∏ô.</div>
                    <h3>${item.Activity}</h3>
                    <p>${item.Description}</p>
                    ${imgHTML}
                </div>
            `;

            container.appendChild(li);
        });
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    if(SHEET_CSV_URL !== 'YOUR_GOOGLE_SHEET_CSV_LINK_HERE') {
        init();
    } else {
        document.getElementById('loading').innerHTML = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSjnYu4EMm4xlYqKA0PuPDVRU6-X7H7aCkXm70gokacZ-vPPa-J9-QXzQb5O-m7sGTdHZbE_9cE_sd5/pub?gid=0&single=true&output=csv";
    }
</script>

</body>
</html>
